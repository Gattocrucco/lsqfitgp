
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>8. Fitting &#8212; lsqfitgp 0.12 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="9. Random sampling" href="raniter.html" />
    <link rel="prev" title="7. Structured arrays wrapping" href="array.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">lsqfitgp 0.12</a></h1>



<p class="blurb">A general purpose Gaussian process regression module</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Gattocrucco&repo=lsqfitgp&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="userguide.html">User guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="reference.html">Reference manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kernelsref.html">1. Kernels reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel.html">2. Generic kernel classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="kerneldec.html">3. Kernel decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernelop.html">4. Kernel operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="deriv.html">5. Derivative specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="gp.html">6. Gaussian process class</a></li>
<li class="toctree-l2"><a class="reference internal" href="array.html">7. Structured arrays wrapping</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">8. Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="raniter.html">9. Random sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="reference.html">Reference manual</a><ul>
      <li>Previous: <a href="array.html" title="previous chapter"><span class="section-number">7. </span>Structured arrays wrapping</a></li>
      <li>Next: <a href="raniter.html" title="next chapter"><span class="section-number">9. </span>Random sampling</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="array.html" title="Previous document"><span class="section-number">7. </span>Structured arrays wrapping</a>
        </li>
        <li>
          <a href="raniter.html" title="Next document"><span class="section-number">9. </span>Random sampling</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="fitting">
<span id="fit"></span><h1><span class="section-number">8. </span>Fitting<a class="headerlink" href="#fitting" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="lsqfitgp.empbayes_fit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lsqfitgp.</span></span><span class="sig-name descname"><span class="pre">empbayes_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyperprior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpfactory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raises</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minkw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpfactorykw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gradient'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lsqfitgp.empbayes_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum a posteriori fit.</p>
<p>Maximizes the marginal likelihood of the data with a Gaussian process
model that depends on hyperparameters, multiplied by a prior on the
hyperparameters.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>hyperprior</strong><span class="classifier">scalar, array or dictionary of scalars/arrays</span></dt><dd><p>A collection of gvars representing the prior for the
hyperparameters.</p>
</dd>
<dt><strong>gpfactory</strong><span class="classifier">callable</span></dt><dd><p>A function with signature gpfactory(hyperparams) -&gt; GP object. The
argument <cite>hyperparams</cite> has the same structure of the empbayes_fit
argument <cite>hyperprior</cite>. gpfactory must be JAX-friendly, i.e.,
use jax.numpy and jax.scipy instead of plain numpy/scipy and avoid
assignments to arrays.</p>
</dd>
<dt><strong>data</strong><span class="classifier">dict, tuple or callable</span></dt><dd><p>Dictionary of data that is passed to <cite>GP.marginal_likelihood</cite> on
the GP object returned by <cite>gpfactory</cite>. If a tuple, it contains the
first two arguments to <cite>GP.marginal_likelihood</cite>. If a callable, it
is called with the same arguments of <cite>gpfactory</cite> and must return
the argument(s) for <cite>GP.marginal_likelihood</cite>.</p>
</dd>
<dt><strong>raises</strong><span class="classifier">bool, optional</span></dt><dd><p>If True (default), raise an error when the minimization fails.
Otherwise, use the last point of the minimization as result.</p>
</dd>
<dt><strong>minkw</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments passed to <cite>scipy.optimize.minimize</cite>.</p>
</dd>
<dt><strong>gpfactorykw</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments passed to <cite>gpfactory</cite>, and also to <cite>data</cite> if it
is a callable.</p>
</dd>
<dt><strong>jit</strong><span class="classifier">bool</span></dt><dd><p>If True, use jax’s jit to compile the minimization target. Default
False.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str</span></dt><dd><p>Minimization strategy. Options:</p>
<dl class="simple">
<dt>‘nograd’</dt><dd><p>Use a gradient-free method.</p>
</dd>
<dt>‘gradient’</dt><dd><p>Use a gradient-only method (default).</p>
</dd>
<dt>‘hessian’</dt><dd><p>Use a Newton method with the Hessian.</p>
</dd>
<dt>‘fisher’</dt><dd><p>Use a Newton method with the Fisher information matrix plus
the hyperprior precision matrix.</p>
</dd>
<dt>‘hessmod’</dt><dd><p>Use a Newton method with a modified Hessian where the
second derivatives of the prior covariance matrix w.r.t. the
hyperparameters are assumed to be zero.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>RuntimeError</dt><dd><p>The minimization failed and <cite>raises</cite> is True.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>p</strong><span class="classifier">scalar, array or dictionary of scalars/arrays</span></dt><dd><p>A collection of gvars representing the hyperparameters that
maximize the marginal likelihood. The covariance matrix is computed
as the inverse of the hessian of the marginal likelihood. These
gvars do not track correlations with the hyperprior or the data.</p>
</dd>
<dt><strong>minresult</strong><span class="classifier">scipy.optimize.OptimizeResult</span></dt><dd><p>The result object returned by <cite>scipy.optimize.minimize</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="array.html" title="Previous document"><span class="section-number">7. </span>Structured arrays wrapping</a>
        </li>
        <li>
          <a href="raniter.html" title="Next document"><span class="section-number">9. </span>Random sampling</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020-2022, Giacomo Petrillo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/fit.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>