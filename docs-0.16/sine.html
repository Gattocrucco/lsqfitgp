
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>2. First example: a sine &#8212; lsqfitgp 0.16 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. More on kernels" href="kernels.html" />
    <link rel="prev" title="1. Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">lsqfitgp 0.16</a></h1>



<p class="blurb">A general purpose Gaussian process regression module</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Gattocrucco&repo=lsqfitgp&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="userguide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">1. Installation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. First example: a sine</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernels.html">3. More on kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives.html">4. Taking derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrals.html">5. Taking integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="customs.html">6. A custom kernel: text classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="in.html">7. Multidimensional input</a></li>
<li class="toctree-l2"><a class="reference internal" href="partial.html">8. Partial derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="out.html">9. Multidimensional output</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">10. Splitting components</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyper.html">11. Hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyperstruct.html">12. Hyperparameters in the input</a></li>
<li class="toctree-l2"><a class="reference internal" href="nonlinear.html">13. Nonlinear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="optim.html">14. Optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="userguide.html">User guide</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter"><span class="section-number">1. </span>Installation</a></li>
      <li>Next: <a href="kernels.html" title="next chapter"><span class="section-number">3. </span>More on kernels</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="installation.html" title="Previous document"><span class="section-number">1. </span>Installation</a>
        </li>
        <li>
          <a href="kernels.html" title="Next document"><span class="section-number">3. </span>More on kernels</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="first-example-a-sine">
<span id="sine"></span><h1><span class="section-number">2. </span>First example: a sine<a class="headerlink" href="#first-example-a-sine" title="Permalink to this heading">¶</a></h1>
<p>We will go through a very simple example fit to introduce how the module works.
First, import the modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lsqfitgp</span> <span class="k">as</span> <span class="nn">lgp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">gvar</span>
</pre></div>
</div>
<p>I suppose you know about <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.24)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code></a>, but you may not know about <a class="reference external" href="https://gvar.readthedocs.io/en/latest/gvar.html#module-gvar" title="(in gvar v11.11.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar</span></code></a>.
It is a module for automatic linear correlation tracking. We will se how to use
it in the example, if you want to know more <a class="reference external" href="https://gvar.readthedocs.io/en/latest/">it has a good documentation</a>.</p>
<p>Now we generate some fake data. Let’s make a sine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="c1"># 11 numbers uniformly spaced from -5 to 5</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>We won’t add errors to the data for now. What we are going to do in the next
steps is pretending we don’t know the data comes from a sine, and letting the
fit guess a function that passes through the data.</p>
<p>The first step in using a Gaussian process is choosing a <em>kernel function</em>. Say
<span class="math notranslate nohighlight">\(f\)</span> is the unknown function we want to model. The kernel function
<span class="math notranslate nohighlight">\(k(x, x')\)</span> specifies the covariance we expect <em>a priori</em> between
<span class="math notranslate nohighlight">\(f(x)\)</span> and <span class="math notranslate nohighlight">\(f(x')\)</span>:</p>
<div class="math notranslate nohighlight">
\[k(x, x') = \operatorname{Cov}[f(x), f(x')].\]</div>
<p>This means that the <em>a priori</em> variance of <span class="math notranslate nohighlight">\(f(x)\)</span> is
<span class="math notranslate nohighlight">\(\operatorname{Var}[f(x)] = k(x, x)\)</span>, and the <em>a priori</em> correlation
between <span class="math notranslate nohighlight">\(f(x)\)</span> and <span class="math notranslate nohighlight">\(f(x')\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\operatorname{Corr}[f(x), f(x')] &amp;=
\frac {\operatorname{Cov}[f(x), f(x')]}
      {\sqrt{\operatorname{Var}[f(x)] \operatorname{Var}[f(x')]}} = \\
&amp;= \frac {k(x, x')} {\sqrt{k(x, x) k(x', x')}}.\end{split}\]</div>
<p>Again, in other words: <span class="math notranslate nohighlight">\(\sqrt{k(x, x)}\)</span> expresses how much you are
uncertain on the function value at <span class="math notranslate nohighlight">\(x\)</span> before seeing the data, and
<span class="math notranslate nohighlight">\(k(x, x')\)</span> expresses how much you think the value at point <span class="math notranslate nohighlight">\(x\)</span> is
linked with the value at point <span class="math notranslate nohighlight">\(x'\)</span>.</p>
<p><a class="reference internal" href="index.html#module-lsqfitgp" title="lsqfitgp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lsqfitgp</span></code></a> allows you to specify arbitrary functions as kernels; however,
not all functions are valid kernels, so it is convenient to use one of the
already available ones from the module. We will use a quite common kernel, the
<em>exponential quadratic</em>:</p>
<div class="math notranslate nohighlight">
\[k(x, x') = \exp \left( \frac 12 (x - x')^2 \right)\]</div>
<p>which is available as <a class="reference internal" href="kernelsref.html#lsqfitgp.ExpQuad" title="lsqfitgp.ExpQuad"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpQuad</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">ExpQuad</span><span class="p">()</span>
</pre></div>
</div>
<p>Note the parentheses: <a class="reference internal" href="kernelsref.html#lsqfitgp.ExpQuad" title="lsqfitgp.ExpQuad"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpQuad</span></code></a> is a class, and we create an instance by
calling it.</p>
<p>Now we build a <a class="reference internal" href="gp.html#lsqfitgp.GP" title="lsqfitgp.GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">GP</span></code></a> object, providing as argument the kernel we want to
use, and tell it we want to evaluate the process on the array of points <code class="docutils literal notranslate"><span class="pre">x</span></code>
we created before:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gproc</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">GP</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
<span class="n">gproc</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>So, we add points using the <a class="reference internal" href="gp.html#lsqfitgp.GP.addx" title="lsqfitgp.GP.addx"><code class="xref py py-meth docutils literal notranslate"><span class="pre">addx()</span></code></a> method of <a class="reference internal" href="gp.html#lsqfitgp.GP" title="lsqfitgp.GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">GP</span></code></a> objects. It
won’t be very useful to only ask for the process values on the data—we
already know the answer there—so we add another array of points, more finely
spaced, and more extended:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xpred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">gproc</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">xpred</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When adding <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">xpred</span></code>, we also provided two strings to
<a class="reference internal" href="gp.html#lsqfitgp.GP.addx" title="lsqfitgp.GP.addx"><code class="xref py py-meth docutils literal notranslate"><span class="pre">addx()</span></code></a>, <code class="docutils literal notranslate"><span class="pre">'foo'</span></code> and <code class="docutils literal notranslate"><span class="pre">'bar'</span></code>. These have no special meaning, they
are just labels the <a class="reference internal" href="gp.html#lsqfitgp.GP" title="lsqfitgp.GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">GP</span></code></a> object uses to distinguish the various arrays
you add to it. You can think of them as variable names.</p>
<p>Now, we ask <code class="docutils literal notranslate"><span class="pre">gproc</span></code> to compute the <em>a posteriori</em> function values on
<code class="docutils literal notranslate"><span class="pre">xpred</span></code> by using the known values on <code class="docutils literal notranslate"><span class="pre">x</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ypred</span> <span class="o">=</span> <span class="n">gproc</span><span class="o">.</span><span class="n">predfromdata</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>So <a class="reference internal" href="gp.html#lsqfitgp.GP.predfromdata" title="lsqfitgp.GP.predfromdata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predfromdata()</span></code></a> takes two arguments; the first is a Python
dictionary with labels as keys and arrays of function values as values, the
second is the label of the points on which we want the estimate.</p>
<p>Now we make a plot of everything:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="s1">&#39;lsqfitgp example&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gaussian process on a sine&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="n">ypred_mean</span> <span class="o">=</span> <span class="n">gvar</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ypred</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpred</span><span class="p">,</span> <span class="n">ypred_mean</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;posterior mean&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sine1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sine1.png" src="_images/sine1.png" />
<p>Notice that, to plot <code class="docutils literal notranslate"><span class="pre">ypred</span></code>, we did <code class="docutils literal notranslate"><span class="pre">ypred_mean</span> <span class="pre">=</span> <span class="pre">gvar.mean(ypred)</span></code>. This
is because the output of <a class="reference internal" href="gp.html#lsqfitgp.GP.predfromdata" title="lsqfitgp.GP.predfromdata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predfromdata()</span></code></a> is not an array of numbers,
but an array of <a class="reference external" href="https://gvar.readthedocs.io/en/latest/gvar.html#gvar.GVar" title="(in gvar v11.11.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a> objects. <code class="xref py py-class docutils literal notranslate"><span class="pre">GVar</span></code> variables represent
Gaussian distributions; <a class="reference external" href="https://gvar.readthedocs.io/en/latest/gvar.html#gvar.mean" title="(in gvar v11.11.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.mean()</span></code></a> extracts the mean of the
distribution. Let’s make an error band for the fit by computing the standard
deviations with <a class="reference external" href="https://gvar.readthedocs.io/en/latest/gvar.html#gvar.sdev" title="(in gvar v11.11.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.sdev()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ypred_sdev</span> <span class="o">=</span> <span class="n">gvar</span><span class="o">.</span><span class="n">sdev</span><span class="p">(</span><span class="n">ypred</span><span class="p">)</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">ypred_mean</span> <span class="o">-</span> <span class="n">ypred_sdev</span>
<span class="n">top</span> <span class="o">=</span> <span class="n">ypred_mean</span> <span class="o">+</span> <span class="n">ypred_sdev</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xpred</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sine2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sine2.png" src="_images/sine2.png" />
<p>Let’s take a moment to look at the result. First, consider the line giving the
mean. Between the data points, it goes smoothly from one point to the next. It
reasonably approximates a sine. However, outside the region with the data it
goes to zero. This is about a thing I forgot to mention when introducing
kernels: apart from the variance and correlations, a Gaussian process also has
an a priori mean. <a class="reference internal" href="index.html#module-lsqfitgp" title="lsqfitgp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lsqfitgp</span></code></a> always assumes that the a priori mean is
zero, so, going far from the data, the a posteriori mean should go to zero too.</p>
<p>It would be easy to provide an arbitrary prior mean by first subtracting it
from the data, and then adding it back to the result. However, I encourage the
reader to avoid using prior means at all while learning Gaussian processes. You
should always think about the links and correlations between the points and the
general properties of the function instead of focusing on what value or
specific functional form you expect, and let the data choose the values and
shape.</p>
<p>Now we look at the band. It is a band of <span class="math notranslate nohighlight">\(\pm1\sigma\)</span> around the
posterior mean (<span class="math notranslate nohighlight">\(\sigma\)</span> stands conventionally for the standard
deviation). For the Gaussian distribution, this interval has a probability of
68 %. A <span class="math notranslate nohighlight">\(\pm2\sigma\)</span> interval would have a probability of 95 %, so this
means that the fit expects the function to stay most of the time within a band
twice as large as that plotted, and 2/3 of the time inside the one plotted. So,
the summary of the figure is this: close to the points, the function is
probably a sine; as soon as we move out from the datapoints, the fit gives up
and just returns the prior.</p>
<p>Instead of trying to interpret what functions the fit result is representing,
we can write a code to sample some plausible functions from the posterior
distribution. <a class="reference external" href="https://gvar.readthedocs.io/en/latest/gvar.html#module-gvar" title="(in gvar v11.11.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar</span></code></a> has a function for doing that, <a class="reference external" href="https://gvar.readthedocs.io/en/latest/gvar.html#gvar.raniter" title="(in gvar v11.11.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.raniter()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ypred_sample</span> <span class="ow">in</span> <span class="n">gvar</span><span class="o">.</span><span class="n">raniter</span><span class="p">(</span><span class="n">ypred</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpred</span><span class="p">,</span> <span class="n">ypred_sample</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sine3.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sine3.png" src="_images/sine3.png" />
<p>What do we learn from this? First, the sampled functions are a bit uglier than
the mean line, even between the datapoints. To have a clear idea of the result,
you should always plot some samples instead of looking at the mean.</p>
<p>Second, outside the datapoints the sampled functions oscillate with peaks that
are a bit too narrow compared to the peaks of the sine. This is invisible by
looking at the error band, so again: to have a clear idea of the result, plot
some samples instead of looking at the error band.</p>
<p>Now, to try to get a smooth fit, we want to increase the “wavelength” of the
kernel to match that of the sine. To do that, we just need to rescale the
input points prior to feeding them to the kernel. We could do that by hand by
multiplying <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">xpred</span></code> by something, but all <a class="reference internal" href="kernel.html#lsqfitgp.Kernel" title="lsqfitgp.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></a> objects
provide a convenient parameter to do that automatically, <code class="docutils literal notranslate"><span class="pre">scale</span></code>. So
let’s do everything again, rescaling by a factor of 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">GP</span><span class="p">(</span><span class="n">lgp</span><span class="o">.</span><span class="n">ExpQuad</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">gp</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">xpred</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">ypred</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">predfromdata</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span> <span class="c1"># clear the plot</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.k&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">gvar</span><span class="o">.</span><span class="n">raniter</span><span class="p">(</span><span class="n">ypred</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpred</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sine4.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sine4.png" src="_images/sine4.png" />
<p>This is a bit more similar to the sine. Between the datapoints, the samples
all follow the same path, and they continue to oscillate in a reasonable way
also outside from the datapoints. But what further away? Let’s make a plot
from -20 to 20:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xpred_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">xpred_long</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">)</span>

<span class="n">ypred</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">predfromdata</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span> <span class="s1">&#39;baz&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.k&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">gvar</span><span class="o">.</span><span class="n">raniter</span><span class="p">(</span><span class="n">ypred</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpred_long</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sine5.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sine5.png" src="_images/sine5.png" />
<p>So, after a an oscillation, it still goes back to the prior, as it should. It
just goes on 3 times as much as before because we set <code class="docutils literal notranslate"><span class="pre">scale=3</span></code>.</p>
<p>Finally, for completeness, let’s see how to add errors to the data. First, we
generate some Gaussian distributed errors with standard deviation 0.2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">yerr</span>
</pre></div>
</div>
<p>Then, we build an array of <code class="xref py py-class docutils literal notranslate"><span class="pre">GVar</span></code> variables from <code class="docutils literal notranslate"><span class="pre">y</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gy</span> <span class="o">=</span> <span class="n">gvar</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">gy</span></code> represents an array of independent Gaussian distributions with mean
<code class="docutils literal notranslate"><span class="pre">y</span></code> and standard deviation 0.2. We then repeat everything as before, but
using <code class="docutils literal notranslate"><span class="pre">gy</span></code> instead of <code class="docutils literal notranslate"><span class="pre">y</span></code>; we don’t even need to recreate the <a class="reference internal" href="gp.html#lsqfitgp.GP" title="lsqfitgp.GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">GP</span></code></a>
object because we are not modifying the <span class="math notranslate nohighlight">\(x\)</span> points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ypred</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">predfromdata</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="n">gy</span><span class="p">},</span> <span class="s1">&#39;baz&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gvar</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gy</span><span class="p">),</span> <span class="n">yerr</span><span class="o">=</span><span class="n">gvar</span><span class="o">.</span><span class="n">sdev</span><span class="p">(</span><span class="n">gy</span><span class="p">),</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">gvar</span><span class="o">.</span><span class="n">raniter</span><span class="p">(</span><span class="n">ypred</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpred_long</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sine6.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sine6.png" src="_images/sine6.png" />
<p>The behaviour makes sense: the samples are not forced any more to pass strictly
on the datapoints.</p>
<p>You should now know all the basics. You can experiment using other kernels, the
available ones are listed in the <a class="reference internal" href="kernelsref.html#kernels"><span class="std std-ref">Kernels reference</span></a>.</p>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="installation.html" title="Previous document"><span class="section-number">1. </span>Installation</a>
        </li>
        <li>
          <a href="kernels.html" title="Next document"><span class="section-number">3. </span>More on kernels</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020-2023, Giacomo Petrillo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/sine.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>