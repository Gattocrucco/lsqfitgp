
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>12. Hyperparameters in the input &#8212; lsqfitgp 0.13 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="13. Nonlinear models" href="nonlinear.html" />
    <link rel="prev" title="11. Hyperparameters" href="hyper.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">lsqfitgp 0.13</a></h1>



<p class="blurb">A general purpose Gaussian process regression module</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Gattocrucco&repo=lsqfitgp&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="userguide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">1. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="sine.html">2. First example: a sine</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernels.html">3. More on kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives.html">4. Taking derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrals.html">5. Taking integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="customs.html">6. A custom kernel: text classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="in.html">7. Multidimensional input</a></li>
<li class="toctree-l2"><a class="reference internal" href="partial.html">8. Partial derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="out.html">9. Multidimensional output</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">10. Splitting components</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyper.html">11. Hyperparameters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">12. Hyperparameters in the input</a></li>
<li class="toctree-l2"><a class="reference internal" href="nonlinear.html">13. Nonlinear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="optim.html">14. Optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="userguide.html">User guide</a><ul>
      <li>Previous: <a href="hyper.html" title="previous chapter"><span class="section-number">11. </span>Hyperparameters</a></li>
      <li>Next: <a href="nonlinear.html" title="next chapter"><span class="section-number">13. </span>Nonlinear models</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="hyper.html" title="Previous document"><span class="section-number">11. </span>Hyperparameters</a>
        </li>
        <li>
          <a href="nonlinear.html" title="Next document"><span class="section-number">13. </span>Nonlinear models</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="hyperparameters-in-the-input">
<span id="hyperstruct"></span><h1><span class="section-number">12. </span>Hyperparameters in the input<a class="headerlink" href="#hyperparameters-in-the-input" title="Permalink to this heading">¶</a></h1>
<p>This section is a bit technical, I will just explain a workaround necessary to
make <a class="reference internal" href="fit.html#lsqfitgp.empbayes_fit" title="lsqfitgp.empbayes_fit"><code class="xref py py-class docutils literal notranslate"><span class="pre">empbayes_fit</span></code></a> work when the hyperparameters enter in the
definition of the Gaussian process from the input points instead of from the
kernel parameters and the input points are multidimensional.</p>
<p>Let’s say you are investigating on a case of disappeared cats in a village. You
want to study the correlation between the number of new cars bought per day and
the number of reported disappeared cats per day.</p>
<p>To make it quick, I’ll first write the model and then generate the fake data
from it for some value of the hyperparameters, then we’ll check if the fit
recovers the correct hyperparameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">gvar</span>
<span class="kn">import</span> <span class="nn">lsqfitgp</span> <span class="k">as</span> <span class="nn">lgp</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">makepoints</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;series&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>  <span class="c1"># 0 = cats, 1 = cars</span>
    <span class="p">])</span>
    <span class="n">points</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>
    <span class="n">points</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">points</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">makegp</span><span class="p">(</span><span class="n">hp</span><span class="p">):</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="n">hp</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">hp</span><span class="p">[</span><span class="s1">&#39;corr&#39;</span><span class="p">]</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">hp</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span>

    <span class="n">kernel</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">ExpQuad</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="n">corr</span><span class="p">],</span> <span class="p">[</span><span class="n">corr</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="n">kernel</span> <span class="o">*=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;series&#39;</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>

    <span class="n">gp</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">GP</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">makepoints</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">points</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">delay</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gp</span>

<span class="n">truehp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;delay&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;corr&#39;</span><span class="p">:</span> <span class="mf">0.70</span><span class="p">,</span>
    <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">}</span>

<span class="n">gp</span> <span class="o">=</span> <span class="n">makegp</span><span class="p">(</span><span class="n">truehp</span><span class="p">)</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">prior</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gvar</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="s1">&#39;lsqfitgp example&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;xk&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cars&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hyperstruct1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/hyperstruct1.png" src="_images/hyperstruct1.png" />
<p>You can see that cats seem to reproduce the trend of cars but with a delay.
Let’s fit now:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hprior</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;delay&#39;</span><span class="p">:</span> <span class="n">gvar</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="s1">&#39;func(corr)&#39;</span><span class="p">:</span> <span class="n">gvar</span><span class="o">.</span><span class="n">BufferDict</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;log(scale)&#39;</span><span class="p">:</span> <span class="n">gvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gvar</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">empbayes_fit</span><span class="p">(</span><span class="n">hprior</span><span class="p">,</span> <span class="n">makegp</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
<span class="n">hp</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
<p>When I run this last piece of code, it fails with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">TracerArrayConversionError</span><span class="p">:</span> <span class="n">The</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">conversion</span> <span class="n">method</span> <span class="n">__array__</span><span class="p">()</span> <span class="n">was</span> <span class="n">called</span> <span class="n">on</span> <span class="n">the</span> <span class="n">JAX</span> <span class="n">Tracer</span> <span class="nb">object</span> <span class="o">...</span>
</pre></div>
</div>
<p>Ok, what went wrong? First, I used <code class="xref py py-func docutils literal notranslate"><span class="pre">np.array()</span></code> in <cite>makegp</cite> without doing
<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">jax</span> <span class="pre">import</span> <span class="pre">numpy</span></code>. Second, I did <code class="docutils literal notranslate"><span class="pre">points['time'][0]</span> <span class="pre">-=</span> <span class="pre">delay</span></code>,
which is an inplace operation, which is not allowed by <code class="xref py py-mod docutils literal notranslate"><span class="pre">jax</span></code>. Fixing the
first is easy, but how do we fix the second? There isn’t an obvious way to put
values into a numpy structured array without assigning to it. For this reason,
<a class="reference internal" href="index.html#module-lsqfitgp" title="lsqfitgp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lsqfitgp</span></code></a> provides a wrapper, <a class="reference internal" href="array.html#lsqfitgp.StructuredArray" title="lsqfitgp.StructuredArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuredArray</span></code></a>, that allows
assigning to fields without breaking <code class="xref py py-mod docutils literal notranslate"><span class="pre">jax</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">jnp</span>

<span class="k">def</span> <span class="nf">makegp</span><span class="p">(</span><span class="n">hp</span><span class="p">):</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="n">hp</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">hp</span><span class="p">[</span><span class="s1">&#39;corr&#39;</span><span class="p">]</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">hp</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span>

    <span class="n">kernel</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">ExpQuad</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">cov</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="n">corr</span><span class="p">],</span> <span class="p">[</span><span class="n">corr</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="c1"># &lt;- jax numpy</span>
    <span class="n">kernel</span> <span class="o">*=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;series&#39;</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>

    <span class="n">gp</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">GP</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">makepoints</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">StructuredArray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">points</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">time</span> <span class="o">-</span> <span class="n">delay</span><span class="p">,</span> <span class="n">time</span><span class="p">])</span> <span class="c1"># &lt;- jax numpy</span>
        <span class="c1"># a StructuredArray can be assigned only a whole field at once</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gp</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">lgp</span><span class="o">.</span><span class="n">empbayes_fit</span><span class="p">(</span><span class="n">hprior</span><span class="p">,</span> <span class="n">makegp</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">},</span> <span class="n">raises</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># we use raises=False because the minimizer is a bit picky.</span>
<span class="n">hp</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">p</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">truehp</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">truehp</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">hp</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">delay</span> <span class="mi">10</span> <span class="mf">10.29</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="n">corr</span> <span class="mf">0.7</span> <span class="mf">0.64</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">scale</span> <span class="mi">3</span> <span class="mf">2.963</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
<p>It seems to work. Let’s plot some samples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timeplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">xplot</span> <span class="o">=</span> <span class="n">makepoints</span><span class="p">(</span><span class="n">timeplot</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hpsamp</span> <span class="ow">in</span> <span class="n">gvar</span><span class="o">.</span><span class="n">raniter</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">gp</span> <span class="o">=</span> <span class="n">makegp</span><span class="p">(</span><span class="n">hpsamp</span><span class="p">)</span>
    <span class="n">xplot</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timeplot</span> <span class="o">-</span> <span class="n">hpsamp</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">addx</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="s1">&#39;plot&#39;</span><span class="p">)</span>
    <span class="n">yplot</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">predfromdata</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">},</span> <span class="s1">&#39;plot&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">gvar</span><span class="o">.</span><span class="n">raniter</span><span class="p">(</span><span class="n">yplot</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeplot</span><span class="p">,</span> <span class="n">sample</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeplot</span><span class="p">,</span> <span class="n">sample</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hyperstruct2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/hyperstruct2.png" src="_images/hyperstruct2.png" />
<p>For better tidiness we should have put subtracting the delay from the time
array for cats into the function <cite>makepoints</cite>.</p>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="hyper.html" title="Previous document"><span class="section-number">11. </span>Hyperparameters</a>
        </li>
        <li>
          <a href="nonlinear.html" title="Next document"><span class="section-number">13. </span>Nonlinear models</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020-2022, Giacomo Petrillo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/hyperstruct.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>